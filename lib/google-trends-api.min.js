!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("https"),require("querystring")):"function"==typeof define&&define.amd?define("google-trends-api",["https","querystring"],t):"object"==typeof exports?exports["google-trends-api"]=t(require("https"),require("querystring")):e["google-trends-api"]=t(e.https,e.querystring)}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(o),u=r(3),a=i["default"].bind(void 0,u.request);t["default"]={resetCookie:u.resetCookie,autoComplete:a("Auto complete"),interestByRegion:a("Interest by region"),interestOverTime:a("Interest over time"),relatedQueries:a("Related queries"),relatedTopics:a("Related topics")},e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t["default"]=function(e,t){var r=(0,n.getResults)(e);return function(e,o){var i=(0,n.constructObj)(e,o),u=i.cbFunc,a=i.obj;return a instanceof Error?Promise.reject(u(a)):r(t,a).then(function(e){return u(null,e)})["catch"](function(e){return Promise.reject(u(e))})}},e.exports=t["default"]},function(e,t){"use strict";function r(e,t){return Math.abs(t-e)/864e5<7}function n(e,t){var r=(e.getUTCMonth()+1).toString();r=r.length<2?"0"+r:r;var n=e.getUTCDate().toString(),o=e.getUTCFullYear().toString(),i=e.getUTCHours(),u=e.getUTCMinutes();return t?o+"-"+r+"-"+n+"T"+i+"\\:"+u+"\\:00":o+"-"+r+"-"+n}function o(e){if(e.startTime&&!(e.startTime instanceof Date))return new Error("startTime must be a Date object");if(e.endTime&&!(e.endTime instanceof Date))return new Error("endTime must be a Date object");if(e.startTime&&e.endTime&&e.startTime>e.endTime){var t=e.startTime;e.startTime=e.endTime,e.endTime=t}e.endTime||(e.endTime=new Date),e.startTime||(e.startTime=new Date("2004-01-01"));var o=r(e.startTime,e.endTime),i=n(e.startTime,o&&e.granularTimeResolution),u=n(e.endTime,o&&e.granularTimeResolution);return e.time=i+" "+u,e}function i(e,t){"function"==typeof e&&(t=e),!e||e&&"object"!==("undefined"==typeof e?"undefined":f(e))||Array.isArray(e)?e=new Error("Must supply an object"):e.keyword||(e=new Error("Must have a keyword field")),t&&"function"!=typeof t&&(e=new Error("Callback function must be a function")),e.hl||(e.hl="en-US"),e.category||(e.category=0),e.timezone||(e.timezone=(new Date).getTimezoneOffset());var r=["images","news","youtube","froogle",""];return r.indexOf(e.property)===-1&&(e.property=""),t||(t=function(e,t){return e?e:t}),e=o(e),{cbFunc:t,obj:e}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=["COUNTRY","REGION","CITY","DMA"],r=t.some(function(t){return t===e.toUpperCase()});return r?e.toUpperCase():""}function a(e){try{return JSON.parse(e.slice(4)).widgets}catch(t){throw t.requestBody=e,t}}function s(e){return Array.isArray(e.keyword)?e.keyword.reduce(function(t,r){return t.push(d({},e,{keyword:r})),t},[]):[e]}function c(e){return function(t,r){var n={"Auto complete":{path:"/trends/api/autocomplete/"+encodeURIComponent(r.keyword)},"Interest over time":{path:"/trends/api/widgetdata/multiline",_id:"TIMESERIES"},"Interest by region":{path:"/trends/api/widgetdata/comparedgeo",resolution:u(r.resolution),_id:"GEO_MAP"},"Related topics":{path:"/trends/api/widgetdata/relatedsearches",_id:"RELATED_TOPICS"},"Related queries":{path:"/trends/api/widgetdata/relatedsearches",_id:"RELATED_QUERIES"}},o={method:"GET",host:"trends.google.com",path:"/trends/api/explore",qs:{hl:r.hl,req:JSON.stringify({comparisonItem:s(r),category:r.category,property:r.property}),tz:r.timezone}};r.agent&&(o.agent=r.agent);var i=n[t],c=i.path,d=i.resolution,f=i._id;return e(o).then(function(n){var o=a(n),i=o.find(function(e){var r=e.id,n=void 0===r?"":r,o=e.request;return n.indexOf(f)>-1||"Auto complete"===t&&o});if(!i){var u={message:"Available widgets does not contain selected api type",requestBody:n};throw u}var s=i.request,p=i.token;d&&(s.resolution=d),s.requestOptions.category=r.category,s.requestOptions.property=r.property,s=JSON.stringify(s);var l={path:c,method:"GET",host:"trends.google.com",qs:{hl:r.hl,req:s,token:p,tz:r.timezone}};return r.agent&&(l.agent=r.agent),e(l)}).then(function(e){try{var t=JSON.stringify(JSON.parse(e.slice(5)));return t}catch(r){return e}})}}Object.defineProperty(t,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isLessThan7Days=r,t.convertDateToString=n,t.formatTime=o,t.constructObj=i,t.formatResolution=u,t.parseResults=a,t.formatKeywords=s,t.getResults=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var r=void 0;r=s["default"].request(e,function(e){var r="";e.on("data",function(e){r+=e}),e.on("end",function(){t(null,r.toString("utf8"))})}),r.on("error",function(e){t(e)}),r.end()}function i(){f=void 0}function u(e){var t=e.method,r=e.host,n=e.path,i=e.qs,u=e.agent,a={host:r,method:t,path:n+"?"+d["default"].stringify(i)};return u&&(a.agent=u),f&&(a.headers={cookie:f}),new Promise(function(e,t){var r=s["default"].request(a,function(r){var n="";r.on("data",function(e){n+=e}),r.on("end",function(){console.log(r.statusCode),429===r.statusCode&&r.headers["set-cookie"]?(f=r.headers["set-cookie"][0].split(";")[0],a.headers={cookie:f},o(a,function(r,n){return r?t(r):void e(n)})):e(n.toString("utf8"))})});r.on("error",function(e){t(e)}),r.end()})}Object.defineProperty(t,"__esModule",{value:!0}),t.resetCookie=i,t.request=u;var a=r(4),s=n(a),c=r(5),d=n(c),f=void 0},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("querystring")}])});
//# sourceMappingURL=google-trends-api.min.js.map